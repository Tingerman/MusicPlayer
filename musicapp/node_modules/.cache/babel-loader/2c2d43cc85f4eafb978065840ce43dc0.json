{"ast":null,"code":"import { onUpdated, ref, watch } from 'vue';\nimport { mapState, mapMutations } from 'vuex';\nimport { onMounted, reactive } from 'vue';\nimport playMusic from '@/components/playMusic.vue';\nexport default {\n  computed: { ...mapState(['playlist', 'playCurrentIndex', 'playing'])\n  },\n  components: {\n    playMusic\n  },\n\n  mounted() {\n    console.log(this.$refs.audio);\n    this.$store.dispatch('reqLyric', {\n      id: this.playlist[this.playCurrentIndex].id\n    });\n    this.UpdateTime();\n  },\n\n  updated() {\n    console.log(\"updated当前曲目\", this.playlist[this.playCurrentIndex]);\n    console.log(\"playing传进来了吗？\", this.playing);\n    this.$store.dispatch('reqLyric', {\n      id: this.playlist[this.playCurrentIndex].id\n    });\n    this.UpdateTime();\n  },\n\n  data() {\n    return {\n      paused: !this.playing,\n      show: false\n    };\n  },\n\n  methods: {\n    play: function () {\n      if (this.$refs.audio.paused) {\n        this.$refs.audio.play();\n        this.playing = true;\n      } else {\n        this.$refs.audio.pause();\n        this.paused = true;\n        clearInterval(this.$store.state.id); // playing=false;\n        // audio_reactive.paused=true;\n      }\n    },\n\n    UpdateTime() {\n      this.$store.state.id = setInterval(() => {\n        this.$store.commit('setCurrentTime', this.$refs.audio.currentTime);\n      }, 1000);\n    }\n\n  }\n};","map":{"version":3,"mappings":"AA2BA,SAASA,SAAT,EAAmBC,GAAnB,EAAuBC,KAAvB,QAAoC,KAApC;AACA,SAAQC,QAAR,EAAiBC,YAAjB,QAAoC,MAApC;AACA,SAAQC,SAAR,EAAkBC,QAAlB,QAAiC,KAAjC;AACA,OAAOC,SAAP,MAAsB,4BAAtB;AAEA,eAAe;EACXC,QAAQ,EAAC,EACL,GAAGL,QAAQ,CAAC,CAAC,UAAD,EAAY,kBAAZ,EAA+B,SAA/B,CAAD;EADN,CADE;EAIXM,UAAU,EAAC;IAACF;EAAD,CAJA;;EAKXG,OAAO,GAAE;IACLC,OAAO,CAACC,GAAR,CAAY,KAAKC,KAAL,CAAWC,KAAvB;IACA,KAAKC,MAAL,CAAYC,QAAZ,CAAqB,UAArB,EAAgC;MAACC,EAAE,EAAC,KAAKC,QAAL,CAAc,KAAKC,gBAAnB,EAAqCF;IAAzC,CAAhC;IACA,KAAKG,UAAL;EACH,CATU;;EAUXC,OAAO,GAAE;IACLV,OAAO,CAACC,GAAR,CAAY,aAAZ,EAA0B,KAAKM,QAAL,CAAc,KAAKC,gBAAnB,CAA1B;IACAR,OAAO,CAACC,GAAR,CAAY,eAAZ,EAA4B,KAAKU,OAAjC;IACA,KAAKP,MAAL,CAAYC,QAAZ,CAAqB,UAArB,EAAgC;MAACC,EAAE,EAAC,KAAKC,QAAL,CAAc,KAAKC,gBAAnB,EAAqCF;IAAzC,CAAhC;IACA,KAAKG,UAAL;EACH,CAfU;;EAgBXG,IAAI,GAAE;IACF,OAAM;MACFC,MAAM,EAAC,CAAC,KAAKF,OADX;MAEFG,IAAI,EAAC;IAFH,CAAN;EAIH,CArBU;;EAsBXC,OAAO,EAAC;IACJC,IAAI,EAAC,YAAU;MACX,IAAG,KAAKd,KAAL,CAAWC,KAAX,CAAiBU,MAApB,EAA2B;QACvB,KAAKX,KAAL,CAAWC,KAAX,CAAiBa,IAAjB;QACA,KAAKL,OAAL,GAAa,IAAb;MACH,CAHD,MAGK;QACD,KAAKT,KAAL,CAAWC,KAAX,CAAiBc,KAAjB;QACA,KAAKJ,MAAL,GAAY,IAAZ;QACAK,aAAa,CAAC,KAAKd,MAAL,CAAYe,KAAZ,CAAkBb,EAAnB,CAAb,CAHC,CAID;QACA;MACJ;IACH,CAZG;;IAaJG,UAAU,GAAE;MACR,KAAKL,MAAL,CAAYe,KAAZ,CAAkBb,EAAlB,GAAqBc,WAAW,CAAC,MAAI;QACjC,KAAKhB,MAAL,CAAYiB,MAAZ,CAAmB,gBAAnB,EAAoC,KAAKnB,KAAL,CAAWC,KAAX,CAAiBmB,WAArD;MACH,CAF+B,EAE9B,IAF8B,CAAhC;IAGJ;;EAjBI;AAtBG,CAAf","names":["onUpdated","ref","watch","mapState","mapMutations","onMounted","reactive","playMusic","computed","components","mounted","console","log","$refs","audio","$store","dispatch","id","playlist","playCurrentIndex","UpdateTime","updated","playing","data","paused","show","methods","play","pause","clearInterval","state","setInterval","commit","currentTime"],"sourceRoot":"","sources":["/Users/wangmanting/Desktop/云e办/音乐播放器vue项目/musicapp/src/components/playController.vue"],"sourcesContent":["<template>\n    <div class=\"playController\">\n        <div class=\"left\" @click=\"show=!show\">\n            <img :src=\"playlist[playCurrentIndex].al.picUrl\" alt=\"\">\n            <div class=\"content\">\n                <div class=\"title\">{{playlist[playCurrentIndex].name}}</div>\n                <div class=\"tips\">横滑可以切换上下首歌</div>\n            </div>\n        </div>\n        <div class=\"right\">\n            <svg class=\"icon play\" v-if=\"paused\" aria-hidden=\"true\" @click=\"play\">\n                <use xlink:href=\"#icon-24gl-playCircle\"></use>\n            </svg>\n            <svg class=\"icon pause\" v-else aria-hidden=\"true\" @click=\"play\">\n                <use xlink:href=\"#icon-zanting\"></use>\n            </svg>  \n            <svg class=\"icon more\" aria-hidden=\"true\">\n                <use xlink:href=\"#icon-liebiao\"></use>\n            </svg>\n        </div>\n\n        <play-music :play=\"play\" :paused='paused' @back=\"show=!show\" v-show=\"show\" :playDetail=\"playlist[playCurrentIndex]\"></play-music>\n        <audio ref=\"audio\" :src=\"`https://music.163.com/song/media/outer/url?id=${playlist[playCurrentIndex].id}.mp3`\"></audio>\n    </div>\n</template>\n\n<script>\nimport { onUpdated,ref,watch } from 'vue';\nimport {mapState,mapMutations} from 'vuex'\nimport {onMounted,reactive} from 'vue';\nimport playMusic from '@/components/playMusic.vue'\n\nexport default {\n    computed:{\n        ...mapState(['playlist','playCurrentIndex','playing'])\n    },\n    components:{playMusic},\n    mounted(){\n        console.log(this.$refs.audio);\n        this.$store.dispatch('reqLyric',{id:this.playlist[this.playCurrentIndex].id});\n        this.UpdateTime();\n    },\n    updated(){\n        console.log(\"updated当前曲目\",this.playlist[this.playCurrentIndex]);\n        console.log(\"playing传进来了吗？\",this.playing)\n        this.$store.dispatch('reqLyric',{id:this.playlist[this.playCurrentIndex].id})\n        this.UpdateTime();\n    },\n    data(){\n        return{\n            paused:!this.playing,\n            show:false\n        }\n    },\n    methods:{\n        play:function(){\n            if(this.$refs.audio.paused){\n                this.$refs.audio.play();\n                this.playing=true;\n            }else{\n                this.$refs.audio.pause();\n                this.paused=true;\n                clearInterval(this.$store.state.id);\n                // playing=false;\n                // audio_reactive.paused=true;\n            }\n        },\n        UpdateTime(){\n            this.$store.state.id=setInterval(()=>{\n                this.$store.commit('setCurrentTime',this.$refs.audio.currentTime)\n            },1000)\n        }\n        \n    }\n\n}\n</script>\n\n<style scoped lang=\"less\">\n.playController{\n    z-index: calc(var(--el-index-normal) + 2);\n    background-color: white;\n    border-top:0.4px solid #ccc;\n    width: 7.5rem;\n    height: 1.2rem;\n    position: fixed;\n    left:0;\n    bottom: 0;\n    display: flex;\n    justify-content: space-between;\n    align-items: center;\n    .left{\n        display: flex;\n        flex-direction: row;\n        .content{\n            display: flex;\n            flex-direction: column;\n            width:4rem;\n            .title{\n                height: 0.4rem;\n                overflow: hidden;\n            }\n\n            .tips{\n                color:rgb(120, 120, 120);\n                font-size: 0.24rem;\n                margin-top:0.04rem;\n            }\n        }\n        img{\n            width:0.8rem;\n            height: 0.8rem;\n            border-radius: 50%;\n            margin-left: 0.4rem;\n            margin-right:0.3rem;\n        }\n\n    }\n    .right{\n        display: flex;\n        flex-direction: row;\n        margin-right: 0.6rem;\n        .icon{\n            width:0.5rem;\n            height: 0.5rem;\n            fill:#333;\n            // margin-left:0.4rem;\n        }\n        .more{\n            margin-left:0.4rem;\n        }\n        .pause{\n            width: 0.45rem;\n            height: 0.45rem;\n            position: relative;\n            right:0.02rem;\n            bottom:-0.02rem;\n        }\n    }\n\n}\n\n</style>"]},"metadata":{},"sourceType":"module"}