{"ast":null,"code":"import { searchMusic } from '@/api/index.js';\nimport { setPlayIndex } from '@/api/index.js';\nimport { mapMutations } from 'vuex';\nimport { mapState } from \"vuex\";\nexport default {\n  props: ['playlist'],\n  computed: { ...mapState(['playlist', 'playCurrentIndex'])\n  },\n  data: () => {\n    return {\n      placeholder: \"Racheal Yamagata\",\n      keywordList: ['杨千嬅', '方大同'],\n      searchKeyword: '',\n      searchSongs: []\n    };\n  },\n\n  beforeMount() {\n    // localStorage.keywordList=\"\";\n    console.log(\"localStorage\", localStorage.keywordList);\n    this.keywordList = localStorage.keywordList ? JSON.parse(localStorage.keywordList) : this.keywordList;\n  },\n\n  methods: {\n    computed: { ...mapState(['playlist', 'playCurrentIndex', 'playing'])\n    },\n    saveKeyword: async function () {\n      this.keywordList.push(this.searchKeyword);\n      this.keywordList = Array.from(new Set(this.keywordList));\n\n      if (this.keywordList.length > 10) {\n        this.keywordList = this.keywordList.slice(this.keywordList.length - 10);\n      }\n\n      localStorage.keywordList = JSON.stringify(this.keywordList);\n      let result = await searchMusic(this.searchKeyword); // console.log(\"search result:\",result)\n\n      this.searchSongs = result.data.result.songs;\n      console.log(this.searchSongs);\n      this.searchKeyword = '';\n    },\n\n    clearStorage() {\n      localStorage.keywordList = \"\";\n      this.keywordList = [];\n    },\n\n    setPlay(item) {\n      item.al = item.album;\n      item.al.picUrl = item.album.artist.img1v1Url;\n      console.log(this.playlist);\n      this.$store.commit('pushPlaylist', item); // this.$store.commit('setPlayIndex',this.playlist.length-1)\n\n      this.$store.commit('setPlayIndex', 2);\n    }\n\n  }\n};","map":{"version":3,"mappings":"AA6KA,SAAQA,WAAR,QAA0B,gBAA1B;AACA,SAAQC,YAAR,QAA2B,gBAA3B;AACA,SAAQC,YAAR,QAA2B,MAA3B;AACA,SAAQC,QAAR,QAAuB,MAAvB;AAEA,eAAe;EACXC,KAAK,EAAC,CAAC,UAAD,CADK;EAEXC,QAAQ,EAAC,EACL,GAAGF,QAAQ,CAAC,CAAC,UAAD,EAAY,kBAAZ,CAAD;EADN,CAFE;EAKXG,IAAI,EAAC,MAAI;IACL,OAAM;MACFC,WAAW,EAAC,kBADV;MAEFC,WAAW,EAAC,CAAC,KAAD,EAAO,KAAP,CAFV;MAGFC,aAAa,EAAC,EAHZ;MAIFC,WAAW,EAAC;IAJV,CAAN;EAMH,CAZU;;EAaXC,WAAW,GAAE;IACT;IACAC,OAAO,CAACC,GAAR,CAAY,cAAZ,EAA2BC,YAAY,CAACN,WAAxC;IACA,KAAKA,WAAL,GAAiBM,YAAY,CAACN,WAAb,GAA0BO,IAAI,CAACC,KAAL,CAAWF,YAAY,CAACN,WAAxB,CAA1B,GAA+D,KAAKA,WAArF;EACH,CAjBU;;EAkBXS,OAAO,EAAC;IACAZ,QAAQ,EAAC,EACb,GAAGF,QAAQ,CAAC,CAAC,UAAD,EAAY,kBAAZ,EAA+B,SAA/B,CAAD;IADE,CADT;IAIJe,WAAW,EAAC,kBAAgB;MACxB,KAAKV,WAAL,CAAiBW,IAAjB,CAAsB,KAAKV,aAA3B;MACA,KAAKD,WAAL,GAAiBY,KAAK,CAACC,IAAN,CAAW,IAAIC,GAAJ,CAAQ,KAAKd,WAAb,CAAX,CAAjB;;MACA,IAAG,KAAKA,WAAL,CAAiBe,MAAjB,GAAwB,EAA3B,EAA8B;QAC1B,KAAKf,WAAL,GAAiB,KAAKA,WAAL,CAAiBgB,KAAjB,CAAuB,KAAKhB,WAAL,CAAiBe,MAAjB,GAAwB,EAA/C,CAAjB;MACJ;;MACAT,YAAY,CAACN,WAAb,GAAyBO,IAAI,CAACU,SAAL,CAAe,KAAKjB,WAApB,CAAzB;MACA,IAAIkB,MAAM,GAAC,MAAM1B,WAAW,CAAC,KAAKS,aAAN,CAA5B,CAPwB,CAQxB;;MACA,KAAKC,WAAL,GAAiBgB,MAAM,CAACpB,IAAP,CAAYoB,MAAZ,CAAmBC,KAApC;MACAf,OAAO,CAACC,GAAR,CAAY,KAAKH,WAAjB;MACA,KAAKD,aAAL,GAAmB,EAAnB;IACH,CAhBG;;IAiBJmB,YAAY,GAAE;MACXd,YAAY,CAACN,WAAb,GAAyB,EAAzB;MACA,KAAKA,WAAL,GAAiB,EAAjB;IACF,CApBG;;IAqBJqB,OAAO,CAACC,IAAD,EAAM;MACTA,IAAI,CAACC,EAAL,GAAQD,IAAI,CAACE,KAAb;MACAF,IAAI,CAACC,EAAL,CAAQE,MAAR,GAAeH,IAAI,CAACE,KAAL,CAAWE,MAAX,CAAkBC,SAAjC;MACAvB,OAAO,CAACC,GAAR,CAAY,KAAKuB,QAAjB;MACA,KAAKC,MAAL,CAAYC,MAAZ,CAAmB,cAAnB,EAAkCR,IAAlC,EAJS,CAKT;;MACA,KAAKO,MAAL,CAAYC,MAAZ,CAAmB,cAAnB,EAAkC,CAAlC;IACJ;;EA5BI;AAlBG,CAAf","names":["searchMusic","setPlayIndex","mapMutations","mapState","props","computed","data","placeholder","keywordList","searchKeyword","searchSongs","beforeMount","console","log","localStorage","JSON","parse","methods","saveKeyword","push","Array","from","Set","length","slice","stringify","result","songs","clearStorage","setPlay","item","al","album","picUrl","artist","img1v1Url","playlist","$store","commit"],"sourceRoot":"","sources":["/Users/wangmanting/Desktop/云e办/音乐播放器vue项目/musicapp/src/components/SearchTop.vue"],"sourcesContent":["<template>\n    <div class=\"searchTop\">\n        <div class=\"searchTopNav\">\n            <div class=\"back\" @click=\"$router.go(-1)\">\n                <svg class=\"icon\" aria-hidden=\"true\">\n                    <use xlink:href=\"#icon-guanbi\"></use>\n                </svg>\n            </div>\n            <div class=\"inputbox\">\n                <input type=\"text\" v-model=\"searchKeyword\" :placeholder=\"placeholder\" @keydown.enter=\"saveKeyword\">\n            </div>\n\n            <div class=\"right\" @click=\"saveKeyword\">\n                <svg class=\"icon search\" aria-hidden=\"true\">\n                    <use xlink:href=\"#icon-sousuoxiao\"></use>\n                </svg>\n            </div>\n\n        </div>\n\n        <div class=\"history\" v-show=\"searchSongs.length==0\">\n            <div class=\"historyLeft\">历史</div>\n            <div class=\"historyRight\">\n                <div class=\"keywordItem\" v-for=\"(item,i) in keywordList\" :key=\"i\" @click=\"searchKeyword=item\">{{item}}</div>\n                <div class=\"clearbtn\" @click=\"clearStorage\">清空历史</div>\n            </div>\n        </div>\n\n        <div class=\"list\">\n            <div class=\"playItem\" v-for=\"(item,i) in searchSongs\" :key=\"i\">\n                <div class=\"left\" @click=\"setPlay(item)\">\n                    <div class=\"index\">{{i+1}}</div>\n                    <div class=\"content\">\n                        <div class=\"title\">{{item.name}}</div>\n                        <div class=\"author\">\n                            <!-- <span class=\"tag\" v-for=\"(tag,index) in searchSongs.tags\" :key=\"index\">{{tag}}</span> -->\n                            <!-- <span>{{item.al.name}}</span> -->\n                            {{item.artists[0].name}} · {{item.album.name}}\n                        </div>\n                    </div>\n                </div>\n                <div class=\"right\">\n                    <svg class=\"icon play\" aria-hidden=\"true\" @click=\"setPlay(item)\">\n                        <use xlink:href=\"#icon-24gl-playCircle\"></use>\n                    </svg> \n                    <svg class=\"icon more\" aria-hidden=\"true\">\n                        <use xlink:href=\"#icon-diandiandianshu\"></use>\n                    </svg>\n                </div>\n            </div>\n        </div>\n    </div>\n</template>\n\n<style lang=\"less\">\n.searchTop{\n    width:7.5rem;\n    padding:0 0.4rem;\n    padding-top:0.2rem ;\n    // height:6rem;\n\n    .searchTopNav{\n        display:flex;\n        justify-content: start;\n        width: 100%;\n        height: 1.2rem;\n        align-items: center;\n        font-size: 0.35rem;\n        .icon{\n            width:0.4rem;\n            height: 0.4rem;\n            fill:#333;\n        }\n        .search{\n            margin-left: 0.3rem;\n        }\n        .inputbox{\n            width: 75%;\n            margin-left:0.3rem;\n            height: 0.6rem;\n            input{\n                border: none;\n                outline: none;\n                border-bottom: 1px solid #666;\n                width: 100%;\n                height: 0.5rem;\n            }\n        }\n\n    }\n    .history{\n        display: flex;\n        justify-content: start;\n        height: 0.6rem;\n        padding: 0 0.1rem;\n        flex-wrap: wrap; //自动换行\n        flex:1; //占据剩余宽度\n        .historyLeft{\n            width:1.1rem;\n            height: 0.6rem;\n            font-weight: 800;\n            display:flex;\n            align-items: center;\n            line-height: 0.6rem;\n        }\n        .historyRight{\n            color:#666;\n            display: flex;\n            align-items: center;\n            width: 70%;\n            flex-wrap: wrap; //自动换行\n            flex:1; //占据剩余宽度\n            .keywordItem{\n                display:flex;\n                background-color: #eee;\n                height: 0.55rem;\n                padding: 0 0.2rem;\n                align-items: center;\n                border-radius: 0.3rem;\n                font-size: 0.2rem;\n                margin:0 0.08rem 0.16rem 0.08rem;\n\n            }\n            .clearbtn{\n                font-size: 0.26rem;\n                color:#333;\n                margin:0.06rem 0rem 0.12rem 0.3rem;\n                text-decoration: underline;\n            }\n        }\n    }\n    .list{\n        .playItem{\n            display: flex;\n            justify-content: space-between;\n            padding:0.2rem;\n            .left{\n                display: flex;\n                align-items: center;\n                .index{\n                    color:rgb(120, 120, 120);\n                }\n                .content{\n                    margin-left:0.4rem;\n                    .title{\n                        font-size: 0.3rem;\n                        color:#333;\n                    }\n                    .author{\n                       font-size: 0.1rem;\n                       color:rgb(120, 120, 120); \n                       margin-top:0.02rem;\n                    }\n                }\n            }\n            .right{\n                display: flex;\n                align-items:center ;\n                .icon{\n                    width:0.4rem;\n                    height: 0.4rem;\n                    fill:#333;\n                    margin-left:0.2rem;\n                }\n            }\n        }\n    }\n}\n\n</style>\n\n<script>\n\nimport {searchMusic} from '@/api/index.js'\nimport {setPlayIndex} from '@/api/index.js'\nimport {mapMutations} from 'vuex';\nimport {mapState} from \"vuex\";\n\nexport default {\n    props:['playlist'],\n    computed:{\n        ...mapState(['playlist','playCurrentIndex']),\n    },\n    data:()=>{\n        return{\n            placeholder:\"Racheal Yamagata\",\n            keywordList:['杨千嬅','方大同'],\n            searchKeyword:'',\n            searchSongs:[],\n        }\n    },\n    beforeMount(){\n        // localStorage.keywordList=\"\";\n        console.log(\"localStorage\",localStorage.keywordList)\n        this.keywordList=localStorage.keywordList? JSON.parse(localStorage.keywordList):this.keywordList;\n    },\n    methods:{\n            computed:{\n        ...mapState(['playlist','playCurrentIndex','playing'])\n    },\n        saveKeyword:async function(){\n            this.keywordList.push(this.searchKeyword);\n            this.keywordList=Array.from(new Set(this.keywordList));\n            if(this.keywordList.length>10){\n                this.keywordList=this.keywordList.slice(this.keywordList.length-10);\n            }\n            localStorage.keywordList=JSON.stringify(this.keywordList);\n            let result=await searchMusic(this.searchKeyword);\n            // console.log(\"search result:\",result)\n            this.searchSongs=result.data.result.songs;\n            console.log(this.searchSongs)\n            this.searchKeyword='';\n        },\n        clearStorage(){\n           localStorage.keywordList=\"\"; \n           this.keywordList=[];\n        },\n        setPlay(item){\n            item.al=item.album;\n            item.al.picUrl=item.album.artist.img1v1Url;\n            console.log(this.playlist)\n            this.$store.commit('pushPlaylist',item);\n            // this.$store.commit('setPlayIndex',this.playlist.length-1)\n            this.$store.commit('setPlayIndex',2)\n        }\n    }\n}\n</script>"]},"metadata":{},"sourceType":"module"}